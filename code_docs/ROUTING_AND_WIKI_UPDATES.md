# Routing and Wiki Updates

## Overview
Updated the application to use subdirectory-based routing for lobby rooms and expanded the wiki into a full-featured card guide with images and search functionality.

## Changes Made

### 1. Routing Structure

#### New URL Scheme
- `/lobby` - Main lobby screen (create/join room)
- `/lobby/{roomCode}` - Waiting room for a specific game room
- `/wiki` - Card guide wiki with search

#### Implementation
**game.js** - Updated socket handlers:
- `roomCreated` event now calls `window.history.pushState({}, '', /lobby/${roomCode})`
- `roomJoined` event now calls `window.history.pushState({}, '', /lobby/${roomCode})`

**wiki.js** - Enhanced routing logic:
- Detects URL path using `window.location.pathname`
- Shows lobby page for `/lobby` or root paths
- Shows waiting room for `/lobby/{roomCode}` paths
- Shows wiki page for `/wiki` path
- Back button intelligently returns to correct page (lobby or room)

### 2. Wiki Enhancements

#### Card Images
Each card article now displays an actual card image from the `/cards/` directory:
- Number Cards: `red_0.png`
- Skip: `red_skip.png`
- Reverse: `red_reverse.png`
- Draw Two: `red_draw2.png`
- Wild: `red_wild.png`
- Wild Draw Four: `wild_draw4.png`

#### Search Functionality
- New search input box in the wiki sidebar
- Real-time filtering of articles as user types
- Searches both card titles and descriptions
- Clear search by entering empty text

#### Article Layout
- New grid layout with card image on left, description on right
- `article-grid` container with 200px image column and flexible text column
- Responsive image sizing with hover scale effect
- Enhanced article descriptions with color highlighting

#### Expanded Content
Each card article now includes:
- Card emoji and title
- Card image display
- Description (short summary)
- "What It Does" section
- Points value information
- Rules and mechanics (Draw Stack, Challenge, etc.)
- Comprehensive strategy tips with bullet points

### 3. HTML Structure Updates

#### New Waiting Room Structure
Added dedicated waiting room page with:
- Back button to leave room
- Room code display with copy button
- Player list showing current players
- Start game button (host only)
- Waiting message (non-host)
- Player counter

#### Updated Wiki HTML
```html
<div id="wiki" class="screen">
  <div class="wiki-header">
    <button class="back-btn">‚Üê Back to Lobby</button>
    <h1>üìö Card Guide Wiki</h1>
  </div>
  
  <div class="wiki-container">
    <nav class="wiki-nav">
      <div class="wiki-search">
        <input type="text" id="wikiSearch" placeholder="üîç Search cards..." class="search-input">
      </div>
      <h3>Cards</h3>
      <ul id="wikiTOC"><!-- Generated by wiki.js --></ul>
    </nav>
    
    <div id="wikiArticles" class="wiki-articles">
      <!-- Generated by wiki.js -->
    </div>
  </div>
</div>
```

### 4. CSS Styling Updates

#### Search Bar Styles
```css
.wiki-search {
  margin-bottom: 20px;
}

.search-input {
  width: 100%;
  padding: 10px 15px;
  background: rgba(255, 255, 255, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 10px;
  color: white;
  font-size: 14px;
  transition: all 0.3s;
}

.search-input::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

.search-input:focus {
  outline: none;
  background: rgba(255, 255, 255, 0.3);
  border-color: rgba(255, 255, 255, 0.5);
}
```

#### Article Grid Styles
```css
.article-grid {
  display: grid;
  grid-template-columns: 200px 1fr;
  gap: 30px;
  align-items: start;
}

.article-image {
  display: flex;
  justify-content: center;
  align-items: center;
}

.card-image {
  max-width: 100%;
  height: auto;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
  transition: transform 0.3s;
}

.card-image:hover {
  transform: scale(1.05);
}

.article-text {
  flex: 1;
}

.article-description {
  font-size: 1.1em;
  color: #ff4757;
  margin-bottom: 20px;
  font-weight: 500;
}
```

#### Waiting Room Header
```css
.waiting-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding: 0 20px;
}

.waiting-header h1 {
  margin-bottom: 0;
  flex: 1;
  text-align: center;
}
```

#### Wiki Articles Container
```css
.wiki-articles {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 30px;
}
```

### 5. JavaScript Features

#### wiki.js - New Methods

**filterCards(searchTerm)**
- Searches article titles and descriptions
- Real-time filtering as user types
- Case-insensitive search

**renderWiki()**
- Generates table of contents with emojis
- Creates article grid layouts with images
- Sets up click handlers for TOC navigation

**setupEventListeners()**
- Wiki button navigation
- Smart back button (returns to correct page)
- Search input handling
- Article link navigation

### 6. File Structure
```
public/
‚îú‚îÄ‚îÄ index.html       (Updated with wiki search and waiting room)
‚îú‚îÄ‚îÄ game.js         (Updated routing for /lobby/{roomCode})
‚îú‚îÄ‚îÄ wiki.js         (Complete rewrite with search and images)
‚îú‚îÄ‚îÄ style.css       (Added search and image styling)
‚îî‚îÄ‚îÄ [other files unchanged]
```

## User Experience Flow

1. **Lobby** (`/lobby`)
   - Enter player name
   - Create new room or join existing
   - Click Wiki button to visit card guide

2. **Waiting Room** (`/lobby/{roomCode}`)
   - Share room code with friends
   - See players joining in real-time
   - Wait for host to start game
   - Can navigate back to lobby

3. **Wiki** (`/wiki`)
   - Search for cards by name or description
   - View card images and detailed descriptions
   - Learn about card mechanics and strategies
   - Click TOC links to jump to articles
   - Back button returns to lobby

## Testing Notes
- Syntax verified for game.js and wiki.js
- URL navigation tested with History API
- Search filtering functional for all card types
- Card images display correctly from `/cards/` endpoint
- Responsive layout for different screen sizes

## Future Enhancements
- Add more card images (action card variants)
- Implement card filtering by type
- Add comparison view for multiple cards
- Store user preferences for wiki settings
